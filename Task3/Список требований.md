# Список требований к внешним интеграциям
## Общие требования к безопасности
1. Взаимодействие между внутренним и внешним сервисом должно выполняться при помощи HTTP-запроса
2. API внешнего сервиса должно быть задокументировано и реализовано по стандарту REST API
3. Межсетевое взаимодействие должно быть зашифровано TLS
4. Не допускается хранение персональных данных клиентов на внешнем сервисе
5. Входящий в локальную сеть TCP трафик будет проведен через стек СЗИ как если бы он был untrusted.
## Протоколы аутентификации и авторизации
1. Аутентификация исходящих во внешний сервис запросов должна быть выполнена при помощи выданных внешним сервисом JWT (rfc7519) или Bearer (rfc6760) токенов.
2. Выдача токенов выполняется по запросу на публичный REST API метод внешного сервиса при передаче в теле HTTP запроса учетных данных сервисной учетной записи.
3. Учетные данные сервисной учетной записи хранятся переменных окружение внутреннего сервиса.
## Описание взаимодействия
### Добавление нового "лица" для домофона
1. Клиент (собственник жилья) в мобильном приложении переходит в раздел "Умный дом".
2. Мобильное приложение подгружает фронтенд необходимый для пользовательского взаимодействия.
4. Клиент выбирает раздел "Домофон".
5. Клиент выполняет действие "Добавить новое лицо".
6. Мобильное приложение выполняет фотографирование клиента и формирует биометрический отпечаток.
7. Мобильное приложение отправляет новый биометрический отпечаток на бэкенд.
8. Бэкенд сохраняет отпечаток, связывает его с обезличенным идентификатором пользователя.
9. Бэкенд создает в сервисе "домофон" новый отпечаток для доступа, связанный с домом пользователя.
### Добавление нового госномера
аналогично предыдущему, но вместо вычисления биометрического отпечатка - вычисляется хэш госномера и отправляется на внешний сервер
